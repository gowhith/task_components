<!-- web-audio-stream-element.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Web Audio Stream Element</title>
  <script type="module">
    import { LitElement, html, css } from 'https://unpkg.com/lit@2.5.0/index.js?module';

    class WebAudioStreamElement extends LitElement {
      static properties = {
        isPlaying: { type: Boolean, state: true },
        isMuted: { type: Boolean, state: true },
        volume: { type: Number, state: true }
      };

      constructor() {
        super();
        this.isPlaying = false;
        this.isMuted = false;
        this.volume = 50;
      }

      static styles = css`
        .player {
          display: flex;
          align-items: center;
          gap: 10px;
        }
        button {
          padding: 6px 10px;
          cursor: pointer;
        }
        input[type="range"] {
          width: 100px;
        }
      `;

      render() {
        return html`
          <div class="player">
            <button @click=${this._togglePlay}>
              ${this.isPlaying ? '‚è∏Ô∏è Pause' : '‚ñ∂Ô∏è Play'}
            </button>
            <button @click=${this._toggleMute}>
              ${this.isMuted ? 'üîá' : 'üîä'}
            </button>
            <input
              type="range"
              min="0"
              max="100"
              .value=${this.isMuted ? 0 : this.volume}
              @input=${this._changeVolume}
            />
          </div>
        `;
      }

      _togglePlay() {
        this.isPlaying = !this.isPlaying;
        this.dispatchEvent(new CustomEvent('play-toggled', {
          detail: { isPlaying: this.isPlaying },
          bubbles: true,
          composed: true
        }));
      }

      _toggleMute() {
        this.isMuted = !this.isMuted;
        this.dispatchEvent(new CustomEvent('mute-toggled', {
          detail: { isMuted: this.isMuted },
          bubbles: true,
          composed: true
        }));
        if (this.isMuted) this.volume = 0;
        this.requestUpdate();
      }

      _changeVolume(e) {
        this.volume = Number(e.target.value);
        this.isMuted = this.volume === 0;
        this.dispatchEvent(new CustomEvent('volume-changed', {
          detail: { volume: this.volume },
          bubbles: true,
          composed: true
        }));
      }
    }

    customElements.define('web-audio-stream-element', WebAudioStreamElement);
  </script>

  <style>
    body {
      font-family: sans-serif;
      margin: 20px;
    }
  </style>
</head>
<body>
  <h3>Web Audio Stream Element</h3>
  <web-audio-stream-element></web-audio-stream-element>

  <script>
    const audioComponent = document.querySelector('web-audio-stream-element');

    audioComponent.addEventListener('play-toggled', e => {
      console.log('[Audio UI] Play toggled:', e.detail);
    });

    audioComponent.addEventListener('mute-toggled', e => {
      console.log('[Audio UI] Mute toggled:', e.detail);
    });

    audioComponent.addEventListener('volume-changed', e => {
      console.log('[Audio UI] Volume changed:', e.detail);
    });
  </script>
</body>
</html>
