<!-- status-display.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Status Display Component</title>
  <script type="module">
    import { LitElement, html, css } from 'https://unpkg.com/lit@2.5.0/index.js?module';

    // Tooltip Component
    class StatusTooltip extends LitElement {
      static properties = {
        text: { type: String },
        visible: { type: Boolean, reflect: true }
      };

      constructor() {
        super();
        this.text = '';
        this.visible = false;
      }

      static styles = css`
        :host {
          position: relative;
          display: inline-block;
        }
        .tooltip {
          visibility: hidden;
          background-color: #333;
          color: #fff;
          text-align: left;
          padding: 6px 10px;
          border-radius: 4px;
          position: fixed;
          z-index: 1000;
          white-space: pre-line;
          opacity: 0;
          transition: opacity 0.3s;
          min-width: 180px;
          max-width: 250px;
          pointer-events: none;
        }
        :host(:hover) .tooltip {
          visibility: visible;
          opacity: 1;
        }
      `;

      render() {
        return html`
          <slot @mousemove=${this._updatePosition}></slot>
          <div class="tooltip" role="tooltip" id="tooltip">${this.text}</div>
        `;
      }

      _updatePosition(e) {
        const tooltip = this.shadowRoot.getElementById('tooltip');
        const offset = 10;
        tooltip.style.top = `${e.clientY + offset}px`;
        tooltip.style.left = `${e.clientX + offset}px`;
      }
    }

    customElements.define('status-tooltip', StatusTooltip);

    // Status Indicator Component
    class StatusIndicator extends LitElement {
      static properties = {
        statusData: { type: Object }
      };

      constructor() {
        super();
        this.statusData = { status: 'unknown', lastChecked: '', error: null };
      }

      static styles = css`
        .status-dot {
          width: 14px;
          height: 14px;
          border-radius: 50%;
          display: inline-block;
          margin: 5px;
          cursor: pointer;
          transition: transform 0.2s, box-shadow 0.2s;
        }
        .online { background-color: green; }
        .offline { background-color: red; }
        .degraded { background-color: orange; }
        .unknown { background-color: gray; }
        .status-dot:hover {
          transform: scale(1.2);
          box-shadow: 0 0 5px rgba(0,0,0,0.4);
        }
      `;

      render() {
        const { status, lastChecked, error } = this.statusData;
        const dotClass = ['status-dot', status].join(' ');
        const lastCheckedText = lastChecked ? `Last Checked: ${lastChecked}` : 'Last Checked: N/A';
        const errorText = error ? `Error: ${error}` : 'Error: None';
        const tooltipText = `Status: ${status}\n${lastCheckedText}\n${errorText}`;

        return html`
          <status-tooltip .text=${tooltipText}>
            <div class=${dotClass} role="status" aria-label="${status} status"></div>
          </status-tooltip>
        `;
      }
    }

    customElements.define('status-indicator', StatusIndicator);
  </script>

  <style>
    body {
      font-family: sans-serif;
      margin: 20px;
    }
  </style>
</head>
<body>
  <h3>Service Health Status</h3>

  <!-- Mock Inputs with JSON parsed directly -->
  <status-indicator id="status1"></status-indicator>
  <status-indicator id="status2"></status-indicator>
  <status-indicator id="status3"></status-indicator>

  <script>
    document.getElementById('status1').statusData = {
      status: 'online',
      lastChecked: '2025-07-27T10:00:00Z',
      error: null
    };

    document.getElementById('status2').statusData = {
      status: 'degraded',
      lastChecked: '2025-07-27T11:00:00Z',
      error: 'High latency'
    };

    document.getElementById('status3').statusData = {
      status: 'offline',
      lastChecked: '2025-07-27T12:00:00Z',
      error: 'Timeout error'
    };
  </script>
</body>
</html>
